\section[Ordinary Least Squares Estimation Of AR(p)]{Ordinary Least Squares Estimation Of AR(p)\label{ex:OrdinaryLeastSquaresEstimationARp}}
Consider an AR(p) model with a constant and linear term:
\begin{align*}
y_t = c + d\cdot t + \phi_1 y_{t-1} +\cdot + \phi_p y_{t-p} +u_{t}=Y_{t-1}'\theta + u_t
\end{align*}
  where \(Y_{t-1}=(1,t,y_{t-1},\ldots,y_{t-p})\) and \(u_t\sim WN(0,\sigma_u^2)\).
The ordinary least-squares (OLS) estimator of \(\theta = (c,d,\phi_1,\ldots,\phi_p)\) is
\begin{align*}
\hat{\theta} = {\left(\sum_{t=1}^T Y_{t-1}Y_{t-1}'\right)}^{-1}\sum_{t=1}^T Y_{t-1} y_t    
\end{align*}
Under the assumptions of stationarity and other standard regularity conditions one can derive that
\begin{align*}
\sqrt{T}(\hat{\theta}-\theta)\overset{d}{\rightarrow}\tilde{U}\sim N\left(0,\sigma_u^2~{plim}\left(T^{-1}\sum_{t=1}^T Y_{t-1}Y_{t-1}'\right)^{-1} \right)
\end{align*}
The residual variance may be estimated consistently by
\begin{align*}
\hat{\sigma}_u^2 = \frac{1}{T-length(\theta)}\sum_{t=1}^T\hat{u}_t^2
\end{align*}
where \(\hat{u}_t=y_t -Y_{t-1}'\hat{\theta}\) are the OLS residuals.

\begin{enumerate}
\item Write a \texttt{function OLS = ARpOLS(\(y\),\(p\),\(const\),\(\alpha\))}
  that takes as inputs a data vector $y$ and number of lags $p$.
The input \(const\) is \(1\) if there is a constant in the model,
  \(2\) if there is a constant and a linear trend.
The function outputs a structure OLS,
  which contains the OLS estimates of \(\theta\),
  its standard errors, t-statistics and p-values given significance value \(\alpha\),
  as well as the OLS estimate of \(\sigma_u\).
\item Load simulated data for an AR(4) model given in the CSV file \texttt{AR4.csv}.
Estimate an AR(4) model with a constant term using your \texttt{ARpOLS} function.
\end{enumerate}

\paragraph{Readings}
\begin{itemize}
	\item \textcite{Lutkepohl_2004_UnivariateTimeSeries}
\end{itemize}


\begin{solution}\textbf{Solution to \nameref{ex:OrdinaryLeastSquaresEstimationARp}}
\ifDisplaySolutions
\input{exercises/ols_ar_p_solution.tex}
\fi
\newpage
\end{solution}